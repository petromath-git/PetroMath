extends layout

block content
    .container-fluid
        .card
            .card-header.bg-dark.text-white
                .d-flex.justify-content-between.align-items-center
                    h5.mb-0 Stock Adjustments
                    a.btn.btn-primary(href='/stock-adjustment/add')
                        i.fas.fa-plus
                        |  Add Adjustment

            .card-body
                if messages.error
                    .alert.alert-danger.alert-dismissible.fade.show
                        button.close(type='button' data-dismiss='alert') ×
                        = messages.error
                if messages.success
                    .alert.alert-success.alert-dismissible.fade.show
                        button.close(type='button' data-dismiss='alert') ×
                        = messages.success

                // Filter Section
                form(method='GET' action='/stock-adjustment' id='filterForm')
                    .row
                        .col-md-3
                            .form-group
                                label(for='fromDate') From Date
                                input.form-control(
                                    type='date'
                                    id='fromDate'
                                    name='fromDate'
                                    value=filters.fromDate || ''
                                )
                        .col-md-3
                            .form-group
                                label(for='toDate') To Date
                                input.form-control(
                                    type='date'
                                    id='toDate'
                                    name='toDate'
                                    value=filters.toDate || ''
                                )
                        .col-md-3
                            .form-group
                                label(for='productId') Product
                                select.form-control(
                                    id='productId'
                                    name='productId'
                                )
                                    option(value='') All Products
                                    each product in products
                                        option(
                                            value=product.product_id
                                            selected=filters.productId == product.product_id
                                        )= product.product_name
                        .col-md-3
                            .form-group
                                label(for='adjustmentType') Type
                                select.form-control(
                                    id='adjustmentType'
                                    name='adjustmentType'
                                )
                                    option(value='') All Types
                                    option(value='IN' selected=filters.adjustmentType === 'IN') Stock IN
                                    option(value='OUT' selected=filters.adjustmentType === 'OUT') Stock OUT
                    .row
                        .col-md-12
                            button.btn.btn-primary(type='submit')
                                i.fas.fa-search
                                |  Search
                            a.btn.btn-secondary.ml-2(href='/stock-adjustment') Clear Filters

                hr

                if adjustments && adjustments.length > 0
                    .table-responsive
                        table.table.table-bordered.table-hover.table-sm
                            thead.thead-light
                                tr
                                    th Date
                                    th Product
                                    th Type
                                    th Quantity
                                    th Unit
                                    th Remarks
                                    th Created By
                            tbody
                                each adjustment in adjustments
                                    tr
                                        td= adjustment.formatted_date
                                        td= adjustment.product_name
                                        td
                                            if adjustment.adjustment_type === 'IN'
                                                span.badge.badge-success Stock IN
                                            else
                                                span.badge.badge-danger Stock OUT
                                        td.text-right= parseFloat(adjustment.qty).toFixed(2)
                                        td= adjustment.unit
                                        td= adjustment.remarks || '-'
                                        td= adjustment.created_by
                else
                    .alert.alert-info
                        i.fas.fa-info-circle
                        |  No stock adjustments found